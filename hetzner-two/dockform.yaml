docker:
  context: hetzner-two
  identifier: homeserver

sops:
  age:
    key_file: ${AGE_KEY_FILE}

secrets:
  sops:
    - secrets.env

applications:
  blinko:
    root: ./blinko
    secrets:
      sops:
        - secrets.env
  gustavocastro:
    root: ./gustavocastro
  traefik:
    root: ./traefik
    secrets:
      sops:
        - secrets.env
  vaultwarden:
    root: ./vaultwarden

filesets:
  gustavocastro:
    source: ./gustavocastro/public
    target_volume: gustavocastro
    target_path: /usr/share/nginx/html
    restart_services:
      - web
  traefik_config:
    source: ./traefik/config
    target_volume: traefik_config
    target_path: /etc/traefik
    restart_services:
      - traefik
  traefik_dynamic:
    source: ./traefik/dynamic
    target_volume: traefik_dynamic
    target_path: /dynamic

networks:
  blinko-network:
  traefik:

volumes:
  blinko:
  blinko_postgres:
  vaultwarden:
