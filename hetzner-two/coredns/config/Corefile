# CoreDNS configuration for gustavocastro.com tailnet DNS
# Resolves all subdomains (*.gustavocastro.com) to Traefik Tailscale IP: 100.104.139.20
# Public domains (gustavocastro.com, www) use normal DNS via fallthrough

# Handle gustavocastro.com domains
gustavocastro.com {
    log
    # Match all subdomains and resolve to Traefik Tailscale IP
    template IN A {
        match "^.+\.gustavocastro\.com\.$"
        answer "{{ .Name }} 30 IN A 100.104.139.20"
        fallthrough
    }
    forward . 1.1.1.1 1.0.0.1
}

# Forward all other queries to Cloudflare DNS
. {
    forward . 1.1.1.1 1.0.0.1
    log
    errors
    cache 30
}